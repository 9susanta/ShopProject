<div class="dashboard-container p-6">
  <div class="mb-6">
    <h1 class="text-3xl font-bold" style="color: var(--gray-900);">Admin Dashboard</h1>
    <p class="mt-2" style="color: var(--gray-600);">Overview of store performance and recent activity</p>
  </div>

  <div *ngIf="isLoading()" class="text-center py-12">
    <mat-progress-spinner diameter="50" mode="indeterminate"></mat-progress-spinner>
    <p class="mt-4" style="color: var(--gray-600);">Loading dashboard data...</p>
  </div>

  <div *ngIf="!isLoading() && dashboardData() && dashboardData()?.kpis">
    <!-- KPI Cards -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
      <div class="container-gradient-highlight p-6 rounded-lg">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-sm mb-1" style="color: var(--gray-600);">Today's Sales</p>
            <p class="text-3xl font-bold" style="color: var(--vivid-pink);">
              ₹{{ (dashboardData()?.kpis?.todaySales ?? 0) | number: '1.2-2' }}
            </p>
          </div>
          <div class="gradient-badge p-3 rounded-full">
            <span class="material-icons text-3xl" style="color: white;">attach_money</span>
          </div>
        </div>
      </div>

      <div class="container-gradient-highlight p-6 rounded-lg">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-sm mb-1" style="color: var(--gray-600);">Month Sales</p>
            <p class="text-3xl font-bold" style="color: var(--electric-violet);">
              ₹{{ (dashboardData()?.kpis?.monthSales ?? 0) | number: '1.2-2' }}
            </p>
          </div>
          <div class="badge-gradient p-3 rounded-full">
            <span class="material-icons text-3xl" style="color: white;">trending_up</span>
          </div>
        </div>
      </div>

      <div class="container-gradient-highlight p-6 rounded-lg">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-sm mb-1" style="color: var(--gray-600);">Low Stock Items</p>
            <p class="text-3xl font-bold" style="color: var(--hot-red);">
              {{ dashboardData()?.kpis?.lowStockCount ?? 0 }}
            </p>
          </div>
          <div class="badge-gradient-notification p-3 rounded-full">
            <span class="material-icons text-3xl" style="color: white;">warning</span>
          </div>
        </div>
      </div>

      <div class="container-gradient-highlight p-6 rounded-lg">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-sm mb-1" style="color: var(--gray-600);">Total Products</p>
            <p class="text-3xl font-bold" style="color: var(--gray-900);">
              {{ dashboardData()?.kpis?.totalProducts ?? 0 }}
            </p>
          </div>
          <div style="background: linear-gradient(135deg, var(--gray-100), var(--gray-200));" class="p-3 rounded-full">
            <span class="material-icons text-3xl" style="color: var(--gray-900);">inventory</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Recent Imports and Low Stock -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      <!-- Recent Imports -->
      <div class="container-gradient p-6 rounded-lg">
        <div class="flex items-center justify-between mb-4">
          <h2 class="text-xl font-semibold" style="color: var(--gray-900);">Recent Imports</h2>
          <button
            class="btn-gradient-primary text-sm px-4 py-2 rounded-lg"
            (click)="navigateToImports()"
            [attr.aria-label]="'View all imports'"
          >
            View All
          </button>
        </div>
        <div *ngIf="!dashboardData()?.recentImports || dashboardData()!.recentImports.length === 0" class="text-center py-8" style="color: var(--gray-600);">
          No recent imports
        </div>
        <div *ngIf="dashboardData()?.recentImports && dashboardData()!.recentImports.length > 0" class="space-y-3">
          <div
            *ngFor="let import of dashboardData()!.recentImports"
            class="rounded-lg p-4 cursor-pointer transition-colors"
            style="border: 1px solid var(--gray-200); background: linear-gradient(to right, white, var(--gray-50));"
            (click)="navigateToImportDetails(import.id)"
          >
            <div class="flex items-center justify-between mb-2">
              <span class="font-medium" style="color: var(--gray-900);">{{ import.fileName }}</span>
              <span
                class="px-2 py-1 text-xs rounded text-white"
                [ngClass]="{
                  'status-gradient-success': import.status === 'Completed',
                  'status-gradient-warning': import.status === 'Processing',
                  'status-gradient-error': import.status === 'Failed',
                  'status-gradient-info': import.status === 'Pending'
                }"
              >
                {{ import.status }}
              </span>
            </div>
            <div class="text-sm" style="color: var(--gray-600);">
              <span>{{ import.successRows }} / {{ import.totalRows }} rows</span>
              <span class="mx-2">•</span>
              <span>{{ import.createdAt | date: 'short' }}</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Low Stock Products -->
      <div class="container-gradient p-6 rounded-lg">
        <h2 class="text-xl font-semibold mb-4" style="color: var(--gray-900);">Low Stock Products</h2>
        <div *ngIf="!dashboardData()?.lowStockProducts || dashboardData()!.lowStockProducts.length === 0" class="text-center py-8" style="color: var(--gray-600);">
          No low stock items
        </div>
        <div *ngIf="dashboardData()?.lowStockProducts && dashboardData()!.lowStockProducts.length > 0" class="space-y-3">
          <div
            *ngFor="let product of dashboardData()!.lowStockProducts"
            class="rounded-lg p-4"
            style="border: 1px solid var(--gray-200); background: linear-gradient(to right, white, var(--gray-50));"
          >
            <div class="flex items-center justify-between">
              <div>
                <p class="font-medium" style="color: var(--gray-900);">{{ product.name }}</p>
                <p *ngIf="product.categoryName" class="text-sm" style="color: var(--gray-600);">
                  {{ product.categoryName }}
                </p>
              </div>
              <div class="text-right">
                <p class="text-lg font-semibold" style="color: var(--hot-red);">{{ product.stock }}</p>
                <p class="text-xs" style="color: var(--gray-600);">Threshold: {{ product.lowStockThreshold }}</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


