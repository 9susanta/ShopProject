<div class="file-import">
  <div class="mb-4">
    <label
      class="block text-sm font-medium mb-2"
      style="color: var(--gray-900);"
      [for]="'file-input-' + componentId"
    >
      Select File ({{ acceptedTypes() }})
    </label>
    <div class="dropzone-gradient p-6 rounded-lg mb-4" (click)="fileInput.click()" style="cursor: pointer;">
      <div class="text-center">
        <span class="material-icons text-4xl mb-2" style="color: var(--vivid-pink);">cloud_upload</span>
        <p class="text-sm" style="color: var(--gray-600);">Click to select or drag and drop file here</p>
      </div>
    </div>
    <div class="flex items-center gap-4">
      <input
        [id]="'file-input-' + componentId"
        type="file"
        [accept]="acceptedTypes()"
        (change)="onFileSelected($event)"
        class="hidden"
        #fileInput
      />
      <button
        type="button"
        class="btn-gradient-secondary px-4 py-2 rounded-lg"
        (click)="fileInput.click()"
        [attr.aria-label]="'Select file'"
      >
        <span class="material-icons mr-2">upload_file</span>
        Choose File
      </button>
      <span *ngIf="selectedFile()" class="text-sm" style="color: var(--gray-600);">
        {{ selectedFile()!.name }} ({{ (selectedFile()!.size / 1024).toFixed(2) }} KB)
      </span>
      <button
        *ngIf="selectedFile()"
        type="button"
        class="px-2 py-1 rounded"
        style="color: var(--hot-red);"
        (click)="clear()"
        [attr.aria-label]="'Clear file selection'"
      >
        <span class="material-icons">close</span>
      </button>
    </div>
  </div>

  <div *ngIf="isProcessing()" class="text-center py-8">
    <mat-progress-spinner diameter="40" mode="indeterminate"></mat-progress-spinner>
    <p class="mt-4" style="color: var(--gray-600);">Processing file...</p>
  </div>

  <div *ngIf="preview() && !isProcessing()" class="preview-container">
    <h3 class="text-lg font-semibold mb-4" style="color: var(--gray-900);">Preview (first {{ preview()!.rows.length }} rows)</h3>
    <div class="overflow-x-auto rounded-lg" style="border: 1px solid var(--gray-200);">
      <table class="min-w-full" style="border-collapse: collapse;">
        <thead class="table-header-gradient">
          <tr>
            <th
              *ngFor="let header of preview()!.headers"
              class="px-4 py-3 text-left text-xs font-medium uppercase tracking-wider"
              style="color: var(--gray-600);"
            >
              {{ header }}
            </th>
          </tr>
        </thead>
        <tbody style="background: var(--gray-50);">
          <tr *ngFor="let row of preview()!.rows">
            <td *ngFor="let cell of row" class="px-4 py-3 text-sm" style="color: var(--gray-900);">
              {{ cell }}
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

