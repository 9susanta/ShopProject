<div class="modal-overlay" (click)="cancel.emit()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>Checkout</h2>
      <button class="close-btn" (click)="cancel.emit()" aria-label="Close">
        <span class="material-icons">close</span>
      </button>
    </div>

    <div class="modal-body">
      <!-- Order Summary -->
      <div class="order-summary">
        <h3>Order Summary</h3>
        <div class="summary-items">
          @for (item of cart; track getProductId(item)) {
            <div class="summary-item">
              <span>{{ getProductName(item) }} Ã— {{ item.quantity }}</span>
              <span>{{ formatCurrency(item.subtotal) }}</span>
            </div>
          }
        </div>
        <div class="summary-total">
          <span>Total:</span>
          <span>{{ formatCurrency(total()) }}</span>
        </div>
      </div>

      <!-- Customer Info -->
      <div class="form-section">
        <label for="phone" class="form-label">Customer Phone (Optional)</label>
        <input
          id="phone"
          type="tel"
          class="form-control"
          [value]="customerPhone()"
          (input)="customerPhone.set($any($event.target).value)"
          placeholder="Enter phone number"
        />
      </div>

      <!-- Payment Method -->
      <div class="form-section">
        <label class="form-label">Payment Method</label>
        <div class="payment-methods">
          <label class="payment-method-option" [class.selected]="paymentMethod() === PaymentMethod.Cash">
            <input
              type="radio"
              name="paymentMethod"
              [value]="PaymentMethod.Cash"
              [checked]="paymentMethod() === PaymentMethod.Cash"
              (change)="paymentMethod.set(PaymentMethod.Cash)"
            />
            <span class="payment-method-label">
              <span class="material-icons">money</span>
              <span>Cash</span>
            </span>
          </label>
          <label class="payment-method-option" [class.selected]="paymentMethod() === PaymentMethod.UPI">
            <input
              type="radio"
              name="paymentMethod"
              [value]="PaymentMethod.UPI"
              [checked]="paymentMethod() === PaymentMethod.UPI"
              (change)="paymentMethod.set(PaymentMethod.UPI)"
            />
            <span class="payment-method-label">
              <span class="material-icons">account_balance_wallet</span>
              <span>UPI</span>
            </span>
          </label>
          <label class="payment-method-option" [class.selected]="paymentMethod() === PaymentMethod.Card">
            <input
              type="radio"
              name="paymentMethod"
              [value]="PaymentMethod.Card"
              [checked]="paymentMethod() === PaymentMethod.Card"
              (change)="paymentMethod.set(PaymentMethod.Card)"
            />
            <span class="payment-method-label">
              <span class="material-icons">credit_card</span>
              <span>Card</span>
            </span>
          </label>
          <label class="payment-method-option" [class.selected]="paymentMethod() === PaymentMethod.PayLater">
            <input
              type="radio"
              name="paymentMethod"
              [value]="PaymentMethod.PayLater"
              [checked]="paymentMethod() === PaymentMethod.PayLater"
              (change)="paymentMethod.set(PaymentMethod.PayLater)"
            />
            <span class="payment-method-label">
              <span class="material-icons">schedule</span>
              <span>Pay Later</span>
            </span>
          </label>
        </div>
      </div>
    </div>

    <div class="modal-footer">
      <button class="btn btn-secondary" (click)="cancel.emit()" [disabled]="isProcessing()">
        Cancel
      </button>
      <button
        class="btn btn-primary"
        (click)="onCheckout()"
        [disabled]="isProcessing() || cart.length === 0">
        @if (isProcessing()) {
          Processing...
        } @else {
          Complete Sale
        }
      </button>
    </div>
  </div>
</div>

