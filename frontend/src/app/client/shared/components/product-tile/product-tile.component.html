<div
  class="product-tile"
  [attr.aria-label]="product().name"
  tabindex="0"
  role="button"
  (keydown.enter)="onAddToCart()"
  (keydown.space)="onAddToCart()"
>
  <!-- Product Image -->
  <div class="product-image-container">
    <img
      [src]="imageUrl()"
      [alt]="product().name"
      class="product-image"
      loading="lazy"
      (error)="$event.target.src = imageUrl()"
    />
    @if (isLowStock()) {
      <div class="low-stock-badge">
        Low Stock
      </div>
    }
  </div>

  <!-- Product Info -->
  <div class="product-info">
    <h3 class="product-name" [title]="product().name">
      {{ product().name }}
    </h3>
    @if (product().categoryName) {
      <p class="product-category">
        {{ product().categoryName }}
      </p>
    }
    
    <!-- Price -->
    <div class="product-price">
      <span class="price-amount">₹{{ product().salePrice | number: '1.2-2' }}</span>
      @if (product().mrp && product().mrp > product().salePrice) {
        <span class="price-mrp">₹{{ product().mrp | number: '1.2-2' }}</span>
      }
    </div>

    <!-- Quantity Picker -->
    @if (showQuantityPicker()) {
      <div class="quantity-section">
        <grocery-quantity-picker
          [min]="1"
          [max]="product().availableQuantity ?? UNLIMITED_QUANTITY"
          [initialValue]="quantity() || 1"
          (valueChange)="onQuantityChange($event)"
        ></grocery-quantity-picker>
      </div>
    }

    <!-- Add to Cart Button -->
    <button
      type="button"
      class="add-to-cart-btn"
      (click)="onAddToCart()"
      [disabled]="product().availableQuantity === 0"
      [attr.aria-label]="'Add ' + product().name + ' to cart'"
    >
      @if (product().availableQuantity === 0) {
        <span class="material-icons">block</span>
        <span>Out of Stock</span>
      } @else {
        <span class="material-icons">shopping_cart</span>
        <span class="button-text">Add to Cart</span>
      }
    </button>
  </div>
</div>


